"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
class QueueManager {
    processQueue(job, queue, connection) {
        let jobObject = { job, queue, connection };
        this.checkDriver(jobObject);
    }
    checkDriver(jobObject) {
        switch (jobObject.connection.driver) {
            case "rabbitmq":
                this.dispatchViaRabbitmq(jobObject);
                break;
            default:
                break;
        }
    }
    async dispatchViaRabbitmq(jobObject) {
        let connect = null;
        try {
            connect = require("amqplib");
        }
        catch (error) {
            throw error;
        }
        connect = await require("amqplib").connect(`${jobObject.connection.host}:${jobObject.connection.port}`);
        const channel = await connect.createChannel();
        await channel.assertQueue(jobObject.queue);
        const queueMessage = JSON.stringify(jobObject.job);
        channel.sendToQueue(jobObject.queue, Buffer.from(queueMessage));
    }
}
exports.default = QueueManager;
